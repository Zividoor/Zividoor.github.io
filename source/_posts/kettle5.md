---
title: kettle脚本开发示例
date: 2019-04-25 18:29:59
tag:
---

### 基本转换脚本开发（trans）

新建trans，在主对象树子服务器中右键，新建，填写数据库连接信息。
![info](1.jpg)

在核心对象中选择输入，拖动表输入控件，选择输出拖动插入/更新控件。
![info](2.png)

编辑表输入，选择你要连接的数据库，然后编写查询语句；可以使用 ${} 来表示变量，但需要勾选“替换sql语句里的变量”选项才会生效。
![info](3.png)

建议先不要设置变量，直接使用常量，在查询语句可以独立执行的情况下可以点击预览，预览数据。

在成功预览数据之后，通过按住shift键和鼠标左键连接两个组件。
![info](5.png)

编辑插入/更新组件，选择你要连接的数据库和目标表；可以通过“获取字段”按钮来在动候签表字段和流字段（需要上一步连接操作之后才可以），然后选择查询关键字，即查询条件。在更新字段一栏中，可以通过“获取和更新字段”按钮来自动获取表和流字段，然后选择需要更新的字段，也可以通过“编辑映射”按钮来手动调整映射关系或直接手动修改。
![info](4.png)

然后可以通过启动按钮来验证脚本是否正确，到此为止一个简单的脚本就完成了。

### 任务开发（job）

选择新建job，核心对象中选择通用，使用组件Start， 可以配置任务的定时调度。
![info](7.png)

使用通用中的转换和作业等组件可以调度其他的trans或job。
![info](8.jpg)

选择之前我们写好的trans，至此一个简单的job就算完成了。
